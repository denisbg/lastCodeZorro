{
    "sourceFile": "src/helper/functions.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 9,
            "patches": [
                {
                    "date": 1714722205250,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1719573627134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n       )\r\n   );\r\n }\r\n \r\n-export function calcDevisLineFromHt(qte, unityPrice, reduction, tva) {\r\n+export function xcalcDevisLine(qte, unityPrice, reduction, tva) {\r\n   const obj = {};\r\n   obj.priceTotal = qte * unityPrice;\r\n   obj.amountReduction = (obj.priceTotal / 100) * reduction;\r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n@@ -46,13 +46,14 @@\n   return obj;\r\n }\r\n export function calcDevisLine(qte, unityPrice, reduction, tva) {\r\n   const obj = {};\r\n-  obj.priceTotal = qte * unityPrice;\r\n-  obj.amountReduction = (obj.priceTotal / 100) * reduction;\r\n+  \r\n+  obj.amountReduction =  reduction;\r\n+ \r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n-\r\n-  obj.priceTotalHt = obj.priceTotal - obj.amountReduction;\r\n+  obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n+  obj.priceTotalHt = obj.priceTotal ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                },
                {
                    "date": 1719573901853,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,9 @@\n   obj.amountReduction =  reduction;\r\n  \r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n-  obj.priceTotalHt = obj.priceTotal ;\r\n+  obj.priceTotalHt = obj.priceTotal * tva /100 ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                },
                {
                    "date": 1719577211217,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,9 @@\n   obj.amountReduction =  reduction;\r\n  \r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n-  obj.priceTotalHt = obj.priceTotal * tva /100 ;\r\n+  obj.priceTotalHt = obj.priceTotal /(1+ tva) ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                },
                {
                    "date": 1719577557239,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,12 +48,11 @@\n export function calcDevisLine(qte, unityPrice, reduction, tva) {\r\n   const obj = {};\r\n   \r\n   obj.amountReduction =  reduction;\r\n- \r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n-  obj.priceTotalHt = obj.priceTotal /(1+ tva) ;\r\n+  obj.priceTotalHt = obj.priceTotal /((100+ tva)/100) ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                },
                {
                    "date": 1719577797024,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n   \r\n   obj.amountReduction =  reduction;\r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n-  obj.priceTotalHt = obj.priceTotal /((100+ tva)/100) ;\r\n+  obj.priceTotalHt = obj.priceTotal /((1 + tva)/100) ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                },
                {
                    "date": 1719577875994,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n   \r\n   obj.amountReduction =  reduction;\r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n-  obj.priceTotalHt = obj.priceTotal /((1 + tva)/100) ;\r\n+  obj.priceTotalHt = obj.priceTotal *((1 + tva)/100) ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                },
                {
                    "date": 1719577975538,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n   \r\n   obj.amountReduction =  reduction;\r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n-  obj.priceTotalHt = obj.priceTotal *((1 + tva)/100) ;\r\n+  obj.priceTotalHt = obj.priceTotal /((1 + tva)) ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                },
                {
                    "date": 1719577997276,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -53,9 +53,9 @@\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n   obj.priceTotalHt = obj.priceTotal /((1 + tva)) ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n-  obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n+  obj.amountTva = (obj.priceTotalHt  * tva/100);\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n \r\n   obj.priceTotalTtc = obj.priceTotalHt + obj.amountTva;\r\n   if (!obj.priceTotalTtc) obj.priceTotalTtc = 0;\r\n"
                },
                {
                    "date": 1719578108508,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n   \r\n   obj.amountReduction =  reduction;\r\n   if (!obj.amountReduction) obj.amountReduction = 0;\r\n   obj.priceTotal = (qte * unityPrice) + obj.amountReduction;\r\n-  obj.priceTotalHt = obj.priceTotal /((1 + tva)) ;\r\n+  obj.priceTotalHt = obj.priceTotal /((1 + tva/100)) ;\r\n   if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n \r\n   obj.amountTva = (obj.priceTotalHt  * tva/100);\r\n   if (!obj.amountTva) obj.amountTva = 0;\r\n"
                }
            ],
            "date": 1714722205250,
            "name": "Commit-0",
            "content": "import { entryPoint } from \"../config/entryPoint\";\r\nimport { pathImage } from \"../vars\";\r\nimport noImage from \"../assets/images/noImage.png\";\r\n\r\nconst FileDownload = require(\"js-file-download\");\r\n\r\nexport function downloadFile(url, name, callback = ()=>{}) {\r\n  entryPoint({\r\n    url: url,\r\n    method: \"GET\",\r\n    responseType: \"blob\", // Important\r\n  }).then((response) => {\r\n    FileDownload(response.data, name);\r\n    callback(false);\r\n  });\r\n}\r\n\r\nexport function isPropValuesEqual(subject, target, propNames) {\r\n  return propNames.every((propName) => subject[propName] === target[propName]);\r\n}\r\n\r\nexport function getUniqueItemsByProperties(items, propNames) {\r\n  return items.filter(\r\n    (item, index, array) =>\r\n      index ===\r\n      array.findIndex((foundItem) =>\r\n        isPropValuesEqual(foundItem, item, propNames)\r\n      )\r\n  );\r\n}\r\n\r\nexport function calcDevisLineFromHt(qte, unityPrice, reduction, tva) {\r\n  const obj = {};\r\n  obj.priceTotal = qte * unityPrice;\r\n  obj.amountReduction = (obj.priceTotal / 100) * reduction;\r\n  if (!obj.amountReduction) obj.amountReduction = 0;\r\n\r\n  obj.priceTotalHt = obj.priceTotal - obj.amountReduction;\r\n  if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n\r\n  obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n  if (!obj.amountTva) obj.amountTva = 0;\r\n\r\n  obj.priceTotalTtc = obj.priceTotalHt + obj.amountTva;\r\n  if (!obj.priceTotalTtc) obj.priceTotalTtc = 0;\r\n  return obj;\r\n}\r\nexport function calcDevisLine(qte, unityPrice, reduction, tva) {\r\n  const obj = {};\r\n  obj.priceTotal = qte * unityPrice;\r\n  obj.amountReduction = (obj.priceTotal / 100) * reduction;\r\n  if (!obj.amountReduction) obj.amountReduction = 0;\r\n\r\n  obj.priceTotalHt = obj.priceTotal - obj.amountReduction;\r\n  if (!obj.priceTotalHt) obj.priceTotalHt = 0;\r\n\r\n  obj.amountTva = (obj.priceTotalHt / 100) * tva;\r\n  if (!obj.amountTva) obj.amountTva = 0;\r\n\r\n  obj.priceTotalTtc = obj.priceTotalHt + obj.amountTva;\r\n  if (!obj.priceTotalTtc) obj.priceTotalTtc = 0;\r\n  return obj;\r\n}\r\n\r\nexport function scrollTop(className = \"has-scroll\") {\r\n  if (document.querySelector(`.${className}`))\r\n    document.querySelector(`.${className}`).scrollTo({\r\n      top: 0,\r\n      behavior: \"smooth\",\r\n    });\r\n}\r\n\r\nexport function newObject(obj = {}) {\r\n  return JSON.parse(JSON.stringify(obj));\r\n}\r\n\r\nexport function getPathImage(image) {\r\n  if (!image) return noImage;\r\n  return image.file\r\n    ? URL.createObjectURL(image.file)\r\n    : image.value\r\n    ? pathImage + image.value\r\n    : pathImage + image;\r\n}\r\n\r\nexport function isEqual(a, b) {\r\n  return JSON.stringify(a) === JSON.stringify(b);\r\n}\r\n\r\nexport function copy(x) {\r\n  return JSON.parse(JSON.stringify(x));\r\n}\r\n\r\nexport function indexOfValue(value, array, key = 'id') {\r\n  for (let i = 0; i < array.length; i++) {\r\n    if (value === array[i][key]) {\r\n      return i;\r\n    }\r\n  }\r\n  return -1;\r\n}\r\n\r\nexport function slugify(text) {\r\n  return text\r\n    .toString() // Cast to string\r\n    .toLowerCase() // Convert the string to lowercase letters\r\n    .normalize(\"NFD\") // The normalize() method returns the Unicode Normalization Form of a given string.\r\n    .trim() // Remove whitespace from both sides of a string\r\n    .replace(/\\s+/g, \"-\") // Replace spaces with -\r\n    .replace(/[^\\w\\-]+/g, \"\") // Remove all non-word chars\r\n    .replace(/\\-\\-+/g, \"-\"); // Replace multiple - with single -\r\n}\r\n\r\nexport function parentCategories(data) {\r\n  let parents = [];\r\n  if (data.length) {\r\n    for (let i = 0; i < data.length; i++) {\r\n      if (data[i].parent) {\r\n        let existe = false;\r\n        for (let j = 0; j < parents.length; j++) {\r\n          if (parents[j].id === data[i].parent.id) {\r\n            existe = true;\r\n          }\r\n        }\r\n        if (!existe) {\r\n          parents.push(data[i].parent);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return parents;\r\n}\r\n\r\nexport const uniqid = () => {\r\n  const n = Math.floor(Math.random() * 11);\r\n  const k = Math.floor(Math.random() * 1000000);\r\n  return String.fromCharCode(n) + k;\r\n};\r\n\r\nexport const distanceTwoPoints = (p1, p2) => {\r\n  if (p1.latitude && p1.longitude && p2.latitude && p2.longitude) {\r\n    var R = 3958.8; // Radius of the Earth in miles\r\n    var rlat1 = p1.latitude * (Math.PI / 180); // Convert degrees to radians\r\n    var rlat2 = p2.latitude * (Math.PI / 180); // Convert degrees to radians\r\n    var difflat = rlat2 - rlat1; // Radian difference (latitudes)\r\n    var difflon = (p2.longitude - p1.longitude) * (Math.PI / 180); // Radian difference (longitudes)\r\n    var d =\r\n      2 *\r\n      R *\r\n      Math.asin(\r\n        Math.sqrt(\r\n          Math.sin(difflat / 2) * Math.sin(difflat / 2) +\r\n            Math.cos(rlat1) *\r\n              Math.cos(rlat2) *\r\n              Math.sin(difflon / 2) *\r\n              Math.sin(difflon / 2)\r\n        )\r\n      );\r\n    return d;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport function capitalizeFirstLetter(string) {\r\n  return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nexport const getMsgError = (error, msg = \"Quelque chose s'est mal passé.\") => {\r\n  console.log(error);\r\n  if (error?.response?.data) {\r\n    if (error.response.data?.message) {\r\n      msg = error.response.data.message;\r\n    } else if (error.response.data[\"hydra:description\"] !== undefined) {\r\n      msg = error.response.data[\"hydra:description\"];\r\n    }\r\n  }\r\n  return msg;\r\n};\r\n\r\nexport const trimChar = (string, charToRemove) => {\r\n  while (string.charAt(0) == charToRemove) {\r\n    string = string.substring(1);\r\n  }\r\n  while (string.charAt(string.length - 1) == charToRemove) {\r\n    string = string.substring(0, string.length - 1);\r\n  }\r\n  return string;\r\n};\r\n\r\nexport function isValidHttpUrl(string) {\r\n  let url;\r\n\r\n  try {\r\n    url = new URL(string);\r\n  } catch (_) {\r\n    return false;\r\n  }\r\n\r\n  return url.protocol === \"http:\" || url.protocol === \"https:\";\r\n}\r\n\r\nexport function getDigits(str, regex = /[+-]?\\d+(\\.\\d+)?/g) {\r\n  if (str && str.length) {\r\n    var numb = str.match(regex);\r\n    if (numb && numb.length) {\r\n      return numb.join(\"\");\r\n    }\r\n  }\r\n  return;\r\n}\r\n\r\nexport function renameKeys(obj, { suffix = \"\", prefix = \"\" }) {\r\n  const keyValues = Object.keys(obj).map((key) => {\r\n    const newKey = prefix + key + suffix;\r\n    return { [newKey]: obj[key] };\r\n  });\r\n  return Object.assign({}, ...keyValues);\r\n}\r\n\r\nexport function deleteKeys(obj, keys) {\r\n  for (let i = 0; i < keys.length; i++) {\r\n    if (obj[keys[i]] != undefined) delete obj[keys[i]];\r\n  }\r\n  return obj;\r\n}\r\n\r\nexport function getFloat(val) {\r\n  if(val==0){return val;}\r\n  var myVal = String(val).replace(/,/g, \".\");\r\n  val = Math.round(getDigits(myVal) * 100) / 100;\r\n  if (myVal.indexOf(\".\") != -1 && myVal.substr(-1, 1) == \".\") {\r\n    return val + \".\";\r\n  }\r\n  return val;\r\n}\r\n\r\nexport function sortObjects(objs, key, order = \"asc\") {\r\n  if (order.toLowerCase() == \"asc\") {\r\n    return objs.sort(function (a, b) {\r\n      if (a[key] < b[key]) return -1;\r\n      if (a[key] > b[key]) return 1;\r\n      return 0;\r\n    });\r\n  } else {\r\n    return objs.sort(function (a, b) {\r\n      if (a[key] > b[key]) return -1;\r\n      if (a[key] < b[key]) return 1;\r\n      return 0;\r\n    });\r\n  }\r\n}\r\n\r\nexport function sortObjectsText(objs, key, order = \"asc\") {\r\n  if (order.toLowerCase() == \"asc\") {\r\n    return objs.sort((a, b) =>\r\n      (a[key] || \"\").toString().localeCompare((b[key] || \"\").toString())\r\n    );\r\n  } else {\r\n    return objs.sort((a, b) =>\r\n      (b[key] || \"\").toString().localeCompare((a[key] || \"\").toString())\r\n    );\r\n  }\r\n}\r\n\r\nexport function getUniqueListBy(arr, key) {\r\n  return [...new Map(arr.map(item => [item[key], item])).values()] ;\r\n}"
        }
    ]
}