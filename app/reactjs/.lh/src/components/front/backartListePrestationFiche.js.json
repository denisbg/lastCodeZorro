{
    "sourceFile": "src/components/front/backartListePrestationFiche.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1712137305628,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1712137305628,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect, useRef } from \"react\";\r\nimport Select from \"../ui-elements/select\";\r\nimport PrestationFiche from \"./prestationFiche\";\r\nimport { ArtListFichePrestation } from \"../../assets/styles/frontGlobalStyle\";\r\nimport { Col, Row } from \"react-bootstrap\";\r\nimport GoogleMap from \"google-map-react\";\r\nimport PrestationFicheMap from \"./prestationFicheMap\";\r\nimport { K_SIZE } from \"./markerStyle\";\r\nimport * as vars from \"../../vars\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport Slider from \"react-slick\";\r\n\r\n\r\n\r\nexport default function ArtListePrestationFiche({\r\n  universe = {},\r\n  service = {},\r\n  benefits = [],\r\n  filter,\r\n  setFilter,\r\n  greatPlaces,\r\n  isPending,\r\n  isOlder,\r\n  ...props\r\n}) {\r\n\r\n  //\r\n \r\n\r\n  \r\n  //\r\n\r\n  let refSlider = useRef(null);\r\n  const isTabletOrMobile = useMediaQuery({ query: \"(max-width: 993px)\" });\r\n  const isDesktopOrLaptop = useMediaQuery({\r\n    query: \"(min-width: 994px)\",\r\n  });\r\n  const [state, setState] = useState({\r\n    map: { center: [48.8534, 2.3488], zoom: 1 },\r\n  });\r\n  const [activeBenefit, setActiveBenefit] = useState({ id: null });\r\n\r\n  useEffect(() => {\r\n    if (filter.codePostal.latitude && filter.codePostal.longitude) {\r\n      const cpState = { ...state };\r\n      cpState.map.center = [\r\n        filter.codePostal.latitude,\r\n        filter.codePostal.longitude,\r\n      ];\r\n      setState(cpState);\r\n    }\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [filter.codePostal.latitude, filter.codePostal.longitude]);\r\n\r\n  useEffect(() => {\r\n    if (activeBenefit?.user?.latitude && activeBenefit?.user?.longitude) {\r\n      const cpState = { ...state };\r\n      cpState.map.center = [\r\n        activeBenefit.user.latitude,\r\n        activeBenefit.user.longitude,\r\n      ];\r\n      setState(cpState);\r\n    }\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [activeBenefit]);\r\n\r\n  const rowRender = (row) => (\r\n    <PrestationFiche\r\n      activeBenefit={activeBenefit}\r\n      setActiveBenefit={setActiveBenefit}\r\n      key={row.id}\r\n      row={row}\r\n    />\r\n  );\r\n  const showData = () => {\r\n    if (service === false || isPending)\r\n      return (\r\n        <div className=\"loading-table\" style={{ textAlign: \"center\" }}>\r\n          Chargement...\r\n        </div>\r\n      );\r\n    else if (benefits.length === 0)\r\n      return (\r\n        <h3\r\n          style={{\r\n            textAlign: \"center\",\r\n            width: \"100%\",\r\n            fontSize: \"22px\",\r\n            fontWeight: \"600\",\r\n          }}\r\n        >\r\n          Aucune donnée\r\n        </h3>\r\n      );\r\n\r\n    return benefits.map((row) => {\r\n      return rowRender(row);\r\n    });\r\n  };\r\n\r\n  const _onChildClick = (key, childProps) => {\r\n    let i = null;\r\n    const benefit = benefits.length\r\n      ? benefits.find((val, index) => {\r\n        if (val.id === childProps.id) {\r\n          i = index;\r\n          return true;\r\n        }\r\n      })\r\n      : { id: null };\r\n    if (benefit.id) {\r\n      setActiveBenefit(benefit);\r\n      if (isTabletOrMobile) {\r\n        refSlider.slickGoTo(i);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getTitleService = () => {\r\n    return `${service.name} : ${benefits.length} réparateur${benefits.length > 1 ? \"(s)\" : \"\"\r\n      }`;\r\n  };\r\n\r\n  const places = benefits.length\r\n    ? benefits.map((row) => {\r\n      return (\r\n        <PrestationFicheMap\r\n          key={row.id}\r\n          lat={row.user.latitude}\r\n          lng={row.user.longitude}\r\n          text={\r\n            row.typeService === \"forfait\" ? `${row.minPrice} €` : \"Sur devis\"\r\n          }\r\n          id={row.id}\r\n          // use your hover state (from store, react-controllables etc...)\r\n          activeBenefit={activeBenefit}\r\n        />\r\n      );\r\n    })\r\n    : \"\";\r\n\r\n  const settings = {\r\n    className: \"slider variable-width\",\r\n    infinite: false,\r\n    centerMode: true,\r\n    slidesToShow: 2,\r\n    slidesToScroll: 1,\r\n    variableWidth: true,\r\n    arrows: false,\r\n    focusOnSelect: true,\r\n    initialSlide: 1,\r\n    responsive: [\r\n      {\r\n        breakpoint: 575,\r\n        settings: {\r\n          slidesToShow: 1,\r\n          slidesToScroll: 1,\r\n          initialSlide: 0,\r\n        },\r\n      },\r\n    ],\r\n  };\r\n\r\n\r\n\r\n\r\n  return (\r\n    <ArtListFichePrestation>\r\n      <div className=\"head-list-content\">\r\n        {isOlder &&\r\n          <h1 className=\"title-bloc-products\">\r\n            {service ? getTitleService() : \"\"}\r\n          </h1>}\r\n        <Select\r\n          {...filter.sortBy}\r\n          onChange={(e) => {\r\n            const cpFilter = { ...filter };\r\n            cpFilter.codePostal.error = false;\r\n            cpFilter.sortBy.value = e.value;\r\n            setFilter(cpFilter);\r\n          }}\r\n        />\r\n      </div>\r\n      <Row className=\"bloc-lists-prstation-items\">\r\n\r\n        <Col lg={12} className=\"bloc-map-list\">\r\n          <GoogleMap\r\n            apiKey={vars.mapsApiKey}\r\n            center={state.map.center}\r\n            zoom={state.map.zoom}\r\n            hoverDistance={K_SIZE / 2}\r\n            onChildClick={_onChildClick}\r\n            onGoogleApiLoaded={({ map, maps }) => {\r\n              //console.log(\"map is loaded.\");\r\n            }}\r\n          >\r\n            {places}\r\n          </GoogleMap>\r\n\r\n        </Col>\r\n      </Row>\r\n\r\n\r\n    </ArtListFichePrestation>\r\n  );\r\n}\r\n"
        }
    ]
}